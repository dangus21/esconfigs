{"version":3,"sources":["../src/installDeps.ts"],"sourcesContent":["import {\n\ttype SpawnSyncOptionsWithBufferEncoding,\n\tspawnSync\n} from \"node:child_process\";\nimport { readdirSync } from \"node:fs\";\n\nimport type { ConfigOption, PackageManager } from \"./\";\n\nconst cwd = process.cwd();\nconst currDirFiles = readdirSync(cwd);\n\nconst spawnOptions = {\n\tcwd: cwd,\n\tstdio: \"inherit\",\n\tenv: process.env,\n\tshell: true,\n\tencoding: \"buffer\"\n} as SpawnSyncOptionsWithBufferEncoding;\n\nconst eslintDeps = [\n\t\"@typescript-eslint/eslint-plugin\",\n\t\"@typescript-eslint/parser\",\n\t\"eslint-import-resolver-typescript\",\n\t\"eslint-plugin-babel\",\n\t\"eslint-plugin-html\",\n\t\"eslint-plugin-import\",\n\t\"eslint-plugin-prettier\",\n\t\"eslint-plugin-react-hooks\",\n\t\"eslint-plugin-react\",\n\t\"eslint-plugin-sort-imports-es6-autofix\",\n\t\"eslint-plugin-unused-imports\",\n\t\"eslint-plugin-react-hooks\",\n\t\"eslint@8.57.1\"\n];\n\nconst PACKAGES = {\n\tpnpm: \"pnpm\",\n\tyarn: \"yarn\",\n\tnpm: \"package-lock\"\n};\n\nfunction installDeps({\n\tconfig,\n\tmanager,\n\twithNextJS = false,\n\twithTailwind = false\n}: {\n\tmanager: NonNullable<PackageManager>;\n\tconfig: ConfigOption[];\n\twithNextJS: boolean;\n\twithTailwind: boolean;\n}) {\n\tlet currDirPackageManager = manager;\n\n\tif (\n\t\tcurrDirFiles.length === 0 ||\n\t\t(currDirFiles.length > 0 && !currDirFiles.includes(\"package.json\"))\n\t) {\n\t\tcurrDirPackageManager = \"npm\";\n\t\tspawnSync(currDirPackageManager, [\"init\", \"-y\"], spawnOptions);\n\t}\n\n\tif (manager === \"current\") {\n\t\tfor (const file of currDirFiles) {\n\t\t\tswitch (true) {\n\t\t\t\tcase file.startsWith(PACKAGES.pnpm):\n\t\t\t\t\tcurrDirPackageManager = \"pnpm\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase file.startsWith(PACKAGES.yarn):\n\t\t\t\t\tcurrDirPackageManager = \"yarn\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase file.startsWith(PACKAGES.npm):\n\t\t\t\t\tcurrDirPackageManager = \"npm\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tcurrDirPackageManager = \"pnpm\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tcurrDirPackageManager = manager;\n\t}\n\tconst packages = String(\n\t\t[\n\t\t\t...(config.includes(\"prettier\")\n\t\t\t\t? withTailwind\n\t\t\t\t\t? [\"prettier\", \"prettier-plugin-tailwindcss\"]\n\t\t\t\t\t: [\"prettier\"]\n\t\t\t\t: []),\n\t\t\t...(withNextJS ? [...eslintDeps, \"@next/eslint-plugin-next\"] : []),\n\t\t\t...(config.includes(\"eslint\") ? eslintDeps : []),\n\t\t\t...(config.includes(\"biomejs\") ? [\"@biomejs/biome@latest\"] : [])\n\t\t].join(\" \")\n\t);\n\n\tspawnSync(\n\t\tcurrDirPackageManager,\n\t\t[currDirPackageManager === \"yarn\" ? \"add\" : \"install\", packages],\n\t\tspawnOptions\n\t);\n}\n\nexport { installDeps };\n"],"mappings":"AAAA,OAEC,aAAAA,MACM,qBACP,OAAS,eAAAC,MAAmB,UAI5B,IAAMC,EAAM,QAAQ,IAAI,EAClBC,EAAeF,EAAYC,CAAG,EAE9BE,EAAe,CACpB,IAAKF,EACL,MAAO,UACP,IAAK,QAAQ,IACb,MAAO,GACP,SAAU,QACX,EAEMG,EAAa,CAClB,mCACA,4BACA,oCACA,sBACA,qBACA,uBACA,yBACA,4BACA,sBACA,yCACA,+BACA,4BACA,eACD,EAEMC,EAAW,CAChB,KAAM,OACN,KAAM,OACN,IAAK,cACN,EAEA,SAASC,EAAY,CACpB,OAAAC,EACA,QAAAC,EACA,WAAAC,EAAa,GACb,aAAAC,EAAe,EAChB,EAKG,CACF,IAAIC,EAAwBH,EAU5B,IAPCN,EAAa,SAAW,GACvBA,EAAa,OAAS,GAAK,CAACA,EAAa,SAAS,cAAc,KAEjES,EAAwB,MACxBZ,EAAUY,EAAuB,CAAC,OAAQ,IAAI,EAAGR,CAAY,GAG1DK,IAAY,UACf,QAAWI,KAAQV,EAClB,OAAQ,GAAM,CACb,KAAKU,EAAK,WAAWP,EAAS,IAAI,EACjCM,EAAwB,OACxB,MACD,KAAKC,EAAK,WAAWP,EAAS,IAAI,EACjCM,EAAwB,OACxB,MACD,KAAKC,EAAK,WAAWP,EAAS,GAAG,EAChCM,EAAwB,MACxB,MACD,QACCA,EAAwB,OACxB,KACF,MAGDA,EAAwBH,EAEzB,IAAMK,EAAW,OAChB,CACC,GAAIN,EAAO,SAAS,UAAU,EAC3BG,EACC,CAAC,WAAY,6BAA6B,EAC1C,CAAC,UAAU,EACZ,CAAC,EACJ,GAAID,EAAa,CAAC,GAAGL,EAAY,0BAA0B,EAAI,CAAC,EAChE,GAAIG,EAAO,SAAS,QAAQ,EAAIH,EAAa,CAAC,EAC9C,GAAIG,EAAO,SAAS,SAAS,EAAI,CAAC,uBAAuB,EAAI,CAAC,CAC/D,EAAE,KAAK,GAAG,CACX,EAEAR,EACCY,EACA,CAACA,IAA0B,OAAS,MAAQ,UAAWE,CAAQ,EAC/DV,CACD,CACD","names":["spawnSync","readdirSync","cwd","currDirFiles","spawnOptions","eslintDeps","PACKAGES","installDeps","config","manager","withNextJS","withTailwind","currDirPackageManager","file","packages"]}